<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width" />
    <meta name="keywords" content="python, javascript, django, open-source, ashish dubey, mozilla, wikimedia" />
    <meta name="description" content="Ashish Dubey's Blog" />
    <title> Communication Dashboard in Firefox Marketplace  | Ashish Dubey's Blog</title>
    <link rel="stylesheet" href="https://ashishdubey.xyz/static/style.css" type="text/css"/>
     
  </head>
  <body>
    <div id="container">
      <div id="header">
        <div id="branding">
          <a href="https://ashishdubey.xyz/">Ashish Dubey's Blog</a>
        </div>
        <div id="nav">
          <ul>
            <li><a href="https://ashishdubey.xyz/">Home</a></li>
            <li><a href="https://ashishdubey.xyz/posts.html">Archive</a></li>
            <li><a href="https://ashishdubey.xyz/about.html">About</a></li>
          </ul>
        </div>
        <div style="clear: both"></div>
      </div>
      <div id="content">
  <div class="post">
    <h1>Communication Dashboard in Firefox Marketplace </h2>
    <div class="post-meta">
      <span class="post-date">Posted on March 22, 2014 </span>
    </div>
    <div class="post-content">
      <p><em>This is one of the awfully long-time overdue posts I've had in my mind, but have not been able to make it on this space. But since its never too late, I'm writing about the cool project I was working on while interning at Mozilla during the summer of 2013.</em></p>

<h2>About Marketplace</h2>

<p><a href="https://marketplace.firefox.com">Firefox Marketplace</a>, for the uninitiated is the platform where developers can host their Firefox apps which run on desktop and mobile (of course including Firefox OS). It acts as the central repository of apps, from where users can download and install apps on their systems. And by that I don't mean a plain repository of apps which just allows you to download apps, but also essentials like compatibility checks, app analytics, ratings, reviews, etc. Just like <a href="https://addons.mozilla.org">Firefox Add-ons</a>, there are apps for various kinds of users on Marketplace. Since Mozilla cares much about the quality of the apps served to its users, it makes sure that the apps meet a quality standard before they are available on the Marketplace. For this purpose, there is process of App Review which comes after a new app is submitted to Firefox Marketplace and before it is available to the users for download. App reviewers, which include paid staff and volunteers, take a close look at the submitted apps, beyond just the description of it. It includes inspecting the app's functionality, performance, and security. If the reviewers like it, it goes live for the users to download, if not, the developer (who submits the app) is notified about the issues found during the review, and the developer is expected to fix those before it can be reviewed again and made public.</p>

<h2>About the Problem</h2>

<p>So, in the Marketplace workflow, we have three kinds of users namely, developers, reviewers and users (Firefox users who download the apps). The review process is basically hidden from the users as it is not relevant to them. Its the developers and reviewers which interact with each other during the review process mainly for feedback, reporting issues and asking questions. The Reviewer Tools provides a dashboard for the reviewers to review apps, which allows them to pick apps they want to review, and take actions on the apps they are reviewing (that is reject, make public, delete or ask for more information). On the other hand, Developer Hub is the dashboard for the developers, which they can manage apps (that is upload an app, edit uploaded apps). Though, this is an efficient workflow for both developers and reviewers, but on the communication front they are a bit disconnected. Every time, a reviewer takes an action on an app, its developer is notified about the action and the enclosed comments in an email. If the developer has any question or comment on the action, they reply back to the email which is delivered to a mailing list which has all the reviewers as its members. While the process works and is transparent, its not the best experience for both developers and especially reviewers. There is no central place in Marketplace where users can view all their conversation. It is totally tied up with their email. Also, communication on mailing lists gets messy after a while, reviewers have to keep track of developers' email addresses, among other hassles. So my project for the summer was to revamp this process in the following ways:</p>

<ol>
<li><p>Create a dashboard for both reviewers and developers to access their present and past conversations. This should be used to read and reply to the messages exchanged between the users.</p></li>
<li><p>Bridge the email conversation and dashboard, so that the users can use both modes of communication as they please.</p></li>
</ol>

<h2>About the Solution</h2>

<p>This is what a part of solution looked like:</p>

<p><img src="/static/img/commbadgescreen.png" alt="Dashboard Screenshot" /></p>

<p>This is the communication dashboard frontend which is written over the same codebase that the Firefox Marketplace is based on, that is <a href="https://github.com/mozilla/fireplace">fireplace</a>, which is essentially a homegrown client-side framework with Marketplace specific bits like how the requests are dispatched, responses are cached, and rendered. Later, most of the Marketplacey commonware was abstracted out and <a href="https://github.com/mozilla/commonplace">commonplace</a> was born, which served as the base for all other Marketplace related projects, including communication dashboard frontend, source code of which resides in <a href="https://github.com/mozilla/commbadge">commbadge</a>.</p>

<h2>More About the Solution</h2>

<p>A little about the frontend was described above, but that was only a part of the entire thing. The frontend is basically a client-side app which talks to the Marketplace REST API, for reading/writing communication dashboard data. This is actually how Firefox Marketplace works. The frontend is a client-side app which fetches data from the Marketplace API and renders it using <a href="http://jlongster.github.io/nunjucks">Nunjucks</a> templating library. The Marketplace API codebase is written in Python/Django (codename <a href="https://github.com/mozilla/zamboni">zamboni</a>), and is huge and might require an additional blog post to get into the details. For the purpose of this post, lets just stick to the details of Marketplace API relevant to the communication dashboard API.</p>

<p>The REST API is written using the <a href="http://django-rest-framework.org">Django REST Framework</a>, which makes it really easy and quick for writing new API endpoints, once you understand how it works. Since, I had worked on Tastypie before, it took me a while to understand different parts of DRF work together, but spending time reading the documentation and codebase itself, yielded good results. I realized that DRF is infact, very simple and flexible framework, making it really easy to control different parts of an API request lifecycle in DRF, simply by extending different classes that DRF provides. I've actually used DRF for another personal project of mine, and it helped setup an API in no time.</p>

<p>One requirement of the project, is to be able to handle the incoming email replies. This means that, a reply to a message sent from communication dashboard can be sent over email and the replies should be tied to the same conversation thread. This is done by sending an email for every message that is sent from the communication dashboard, to the recipients of the message through email. A unique reply token is embedded in the <em>Reply-To</em> address of each email, which internally corresponds to a single conversation thread. Whenever a reply is sent to the reply address, the email server pipes the email to the communication dashboard API, which in background then extracts this reply token and figures out which thread it belongs to and creates its record in the database. Works pretty neatly.</p>

<h2>About the Result</h2>

<p>Much of the prototyping was done by the time I was done with my internship, but the project could not get deployed, which kept me from addressing the real issues it might face in production. But it was a fun ride. It was challenging to find edge cases, and dozen of issues which would arise in every single bug that was part of the project.</p>

<p>My project presentation can be viewed at <a href="https://air.mozilla.org/2013-intern-dubey">air.mozilla.org/2013-intern-dubey</a>, slides of which are available <a href="http://slid.es/ashishdubey/internpresentation13">here</a>.</p>

<p>In a nutshell, I had an awesome summer!</p>

<h2>Thanks</h2>

<p>The awesome summer would not be possible and much fun without my supervisor <a href="https://twitter.com/cvanw">cvan</a>. Learnt so much from him and <a href="https://twitter.com/mattbasta">Matt Basta</a> while working on commbadge, commonplace and zamboni, having fun code reviews. <a href="https://twitter.com/clouserw">Wil Clouser</a> and the entire Marketplace team for a place in the awesome team.</p>

<p>Special thanks to <a href="http://ngokevin.com">Kevin Ngo</a> for taking forward the work on communication dashboard, making it awesome and suck less.</p>

    </div>
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ashishdubeysblog'; // required: replace example with your forum shortname
     // var disqus_developer = 1

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
      <div id="footer">
      <div>
          Copyright &copy 2017 Ashish Dubey
          <p>Licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike License</a></p>
        </div>
      </div>
    </div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-24206813-4', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>