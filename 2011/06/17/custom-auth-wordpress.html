<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width" />
    <meta name="keywords" content="python, javascript, django, open-source, ashish dubey, mozilla, wikimedia" />
    <meta name="description" content="Ashish Dubey's Blog" />
    <title> Customized authentication for WordPress users  | Ashish Dubey's Blog</title>
    <link rel="stylesheet" href="https://ashishdubey.xyz/static/style.css" type="text/css"/>
     
  </head>
  <body>
    <div id="container">
      <div id="header">
        <div id="branding">
          <a href="https://ashishdubey.xyz/">Ashish Dubey's Blog</a>
        </div>
        <div id="nav">
          <ul>
            <li><a href="https://ashishdubey.xyz/">Home</a></li>
            <li><a href="https://ashishdubey.xyz/posts.html">Archive</a></li>
            <li><a href="https://ashishdubey.xyz/about.html">About</a></li>
          </ul>
        </div>
        <div style="clear: both"></div>
      </div>
      <div id="content">
  <div class="post">
    <h1>Customized authentication for WordPress users </h2>
    <div class="post-meta">
      <span class="post-date">Posted on June 17, 2011 </span>
    </div>
    <div class="post-content">
      <p>I wanted to integrate Facebook's authentication with my WordPress site's user login system. This had led me stuck for a couple of days because of all the authentication routes that I've known in WordPress would require a correct password to complete authentication. But, in my case, I just needed to authenticate a user without actually user providing a password. That means, I needed a method by which I could authenticate users using just their username or user ID. So after a lot of hacking and reading, I finally found this method that works out for me.
It basically deals with using filters, precisely <code>authenticate</code> filter. The functions added to this filter are executed in <code>wp_authenticate</code> function which is defined in <code>pluggable.php</code> and is the authentication end point in WordPress. If you watch the code in <code>user.php</code>, there you would find that two functions added to this <code>authenticate</code> filter, which are <code>wp_authenticate_username_password</code> with priority 20 and <code>wp_authenticate_cookie</code> with priority 30. <code>wp_authenticate_cookie</code> is not that we want to care about. <code>It's wp_authenticate_username_password</code> that we need to deal with. So when you want to bypass this username and password combined authentication you basically need to bypass the execution of this function and return the user before it. So we'll hook our own method to this filter with a priority less than 20 by the following line of code.</p>

<style>.php .hll { background-color: #ffffcc }
.php  { background: #f0f0f0; }
.php .c { color: #60a0b0; font-style: italic } /* Comment */
.php .err { border: 1px solid #FF0000 } /* Error */
.php .k { color: #007020; font-weight: bold } /* Keyword */
.php .o { color: #666666 } /* Operator */
.php .ch { color: #60a0b0; font-style: italic } /* Comment.Hashbang */
.php .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.php .cp { color: #007020 } /* Comment.Preproc */
.php .cpf { color: #60a0b0; font-style: italic } /* Comment.PreprocFile */
.php .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.php .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.php .gd { color: #A00000 } /* Generic.Deleted */
.php .ge { font-style: italic } /* Generic.Emph */
.php .gr { color: #FF0000 } /* Generic.Error */
.php .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.php .gi { color: #00A000 } /* Generic.Inserted */
.php .go { color: #888888 } /* Generic.Output */
.php .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.php .gs { font-weight: bold } /* Generic.Strong */
.php .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.php .gt { color: #0044DD } /* Generic.Traceback */
.php .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.php .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.php .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.php .kp { color: #007020 } /* Keyword.Pseudo */
.php .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.php .kt { color: #902000 } /* Keyword.Type */
.php .m { color: #40a070 } /* Literal.Number */
.php .s { color: #4070a0 } /* Literal.String */
.php .na { color: #4070a0 } /* Name.Attribute */
.php .nb { color: #007020 } /* Name.Builtin */
.php .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.php .no { color: #60add5 } /* Name.Constant */
.php .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.php .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.php .ne { color: #007020 } /* Name.Exception */
.php .nf { color: #06287e } /* Name.Function */
.php .nl { color: #002070; font-weight: bold } /* Name.Label */
.php .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.php .nt { color: #062873; font-weight: bold } /* Name.Tag */
.php .nv { color: #bb60d5 } /* Name.Variable */
.php .ow { color: #007020; font-weight: bold } /* Operator.Word */
.php .w { color: #bbbbbb } /* Text.Whitespace */
.php .mb { color: #40a070 } /* Literal.Number.Bin */
.php .mf { color: #40a070 } /* Literal.Number.Float */
.php .mh { color: #40a070 } /* Literal.Number.Hex */
.php .mi { color: #40a070 } /* Literal.Number.Integer */
.php .mo { color: #40a070 } /* Literal.Number.Oct */
.php .sb { color: #4070a0 } /* Literal.String.Backtick */
.php .sc { color: #4070a0 } /* Literal.String.Char */
.php .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.php .s2 { color: #4070a0 } /* Literal.String.Double */
.php .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.php .sh { color: #4070a0 } /* Literal.String.Heredoc */
.php .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.php .sx { color: #c65d09 } /* Literal.String.Other */
.php .sr { color: #235388 } /* Literal.String.Regex */
.php .s1 { color: #4070a0 } /* Literal.String.Single */
.php .ss { color: #517918 } /* Literal.String.Symbol */
.php .bp { color: #007020 } /* Name.Builtin.Pseudo */
.php .vc { color: #bb60d5 } /* Name.Variable.Class */
.php .vg { color: #bb60d5 } /* Name.Variable.Global */
.php .vi { color: #bb60d5 } /* Name.Variable.Instance */
.php .il { color: #40a070 } /* Literal.Number.Integer.Long */</style><div class="php"><pre><span></span><span class="x">add_filter(&#39;authenticate&#39;,&#39;forceLogin&#39;,0,3);</span>
</pre></div>


<p>Now suppose you want to define an authentication that doesn't really need a password, just write a function <code>forceLogin()</code> like the following.</p>

<div class="php"><pre><span></span><span class="x">function forceLogin($user,$username,$password)</span>
<span class="x">{</span>
<span class="x">  if(username_exists($username))</span>
<span class="x">  {</span>
<span class="x">    $user=get_user_by(&#39;login&#39;,$username);</span>
<span class="x">    remove_action(&#39;authenticate&#39;, &#39;wp_authenticate_username_password&#39;, 20);</span>
<span class="x">    return $user;</span>
<span class="x">  }</span>
<span class="x">}</span>
</pre></div>


<p>Thats it, now when you call the <code>wp_signon()</code> with just a username in the credentials, the user with the username in the credentials will be authenticated without actually requiring the password. Thats how its done. One can integrate OAuth and construct customized logins for their WordPress websites.</p>

    </div>
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'ashishdubeysblog'; // required: replace example with your forum shortname
     // var disqus_developer = 1

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
      <div id="footer">
      <div>
          Copyright &copy <span id="copyright-year">2017</span> Ashish Dubey
          <p>Licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike License</a></p>
        </div>
      </div>
    </div>
    <script>
      document.querySelector('#copyright-year').innerHTML = (new Date()).getFullYear();

      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-24206813-4', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>